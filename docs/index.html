<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#">
  <head>
    <title>香港交易廣場天台生成器</title>
    <meta charset="utf8">
    <meta property="og:image" content="https://shawtim.github.io/ifc-roof/thumbnail.jpg" />
    <link rel="shortcut icon" href="./thumbnail.jpg">
    <link rel="stylesheet" type="text/css" href="./css/jquery-ui.min.css"> 
    <link rel="stylesheet" type="text/css" href="./css/jquery.timepicker.min.css"> 
    <link rel="stylesheet" type="text/css" href="./css/roof.css"> 
    <script type="text/javascript" src="./js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="./js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="./js/jquery.timepicker.min.js"></script>
    <script type="text/javascript" src="./js/html2canvas.min.js"></script>
    <script>
      var convertImage = () => {
        html2canvas($(".image-container").get(0)).then((canvas) => $(".download-link").attr("href", canvas.toDataURL()));
      };
      $(function() {
        $(".date-picker").datepicker({
          dateFormat: "m d",
          onSelect: (date) => {
            var arr = date.split(' ');
            $(".month").text(arr[0]);
            $(".day").text(arr[1]);
            convertImage();
          }
        });
        $(".time-picker input").timepicker({
          timeFormat: 'h:mm p',
          defaultTime: '17',
          change: (time) => {
            var hour = time.getHours();
            var minutes = time.getMinutes();
            $(".hour").text(hour > 12 ? hour-12 : hour);
            $(".minute").text(minutes < 10 ? '0'+minutes : minutes);
            convertImage();
          }
        });
        $(".location-picker input").keyup((e) => {
          var location = e.target.value;
          if (!!location) {
            $(".location").text(location);
          } else {
            $(".location").text("香港交易廣場天台");
          }
          convertImage();
        })
        $(".month").text(new Date().getMonth()+1);
        $(".day").text(new Date().getDate());
        convertImage();
      });
    </script>
  </head>
  <body>
    <div class="date-picker"></div>
    <div class="time-picker">
      <input type="text"/>
    </div>
    <div class="location-picker">
      <input type="text" placeholder="香港交易廣場天台"/>
    </div>
    <div class="image-container">
      <div class="text-row">
        <div class="month number"></div>
        <div class="month-text text">月</div>
        <div class="day number"></div>
        <div class="day-text text">日</div>
        <div class="hour number">5</div>
        <div class="colon-text text">:</div>
        <div class="minute number">00</div>
        <div class="ampm-text text">PM</div>
        <div class="line-end1"></div>
      </div>
      <div class="text-row">
        <div class="location text">香港交易廣場天台</div>
        <div class="line-end2"></div>
      </div>
    </div>
    <div class="convert-button">
      <a class="download-link" download="交易廣場天台.png"><button>Download</button></a>
    </div>
    <div class="footer">
      Created by <a href="https://github.com/ShawTim">ShawTim</a>. Tested with Firefox Quantum.
    </div>
  </body>
</html>
